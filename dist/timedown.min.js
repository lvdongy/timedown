"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}!function(){function o(e){for(var t in e)return;return 1}window.Timedown=function(){function h(e){var t=e.id,i=e.endTime,o=e.endText,n=void 0===o?"已结束":o,s=e.interval,r=void 0===s?1e3:s,a=e.selector,o=e.format,s=void 0===o?"{d}天 {hh}:{mm}:{ss}":o,o=e.isNotFormatNode,o=void 0!==o&&o,e=e.endCallback;if(_classCallCheck(this,h),i){if(Array.isArray(i))i=new Date(i[0],i[1]-1,i[2]||1,i[4]||0,i[3]||0,i[5]||0).getTime();else if("number"!=typeof i)return void console.error("Parameter type error: endTime");this.config={},this.config.id=t,this.config.endTime=i,this.config.endText=n,this.config.interval=r,this.config.format=s,this.config.endCallback=e,this.config.selector=a,this.config.isNotFormatNode=o,this.isOver=!1,this.value="",this.day=0,this.h=0,this.m=0,this.s=0,this._handleSelector(),this.start()}else console.error("endTime cannot be empty")}return _createClass(h,[{key:"start",value:function(){var e=this,t=this._handleTime();t?(setTimeout(function(){e.start()},this.config.interval),this.value=t.value,this.day=t.day,this.h=t.h,this.m=t.m,this.s=t.s,this.hasNode&&this._upateNode()):this._handleEnd()}},{key:"_upateNode",value:function(){if(this.targetNodes)for(var e in this.targetNodes)if(Object.hasOwnProperty.call(this.targetNodes,e))for(var t=this.targetNodes[e],i=0;i<t.length;i++)null!=this[e]&&("value"===e||this.config.isNotFormatNode?t[i].innerText=this[e]:t[i].innerText=+this[e]<10?"0".concat(this[e]):this[e])}},{key:"_handleTime",value:function(){var e=this.config.endTime;if(e<Date.now())return null;var t=Math.floor((e-Date.now())/1e3),i=Math.floor(t/86400),o=Math.floor(t%86400/3600),e=Math.floor(t%3600/60),t=t%60;return{value:this._handleFormat(i,o,e,t),day:i,h:o,m:e,s:t}}},{key:"_handleEnd",value:function(){this.isOver=!0,this.value=this.config.endText,this.day=this.h=this.m=this.s=0,this.hasNode&&this._upateNode();var e=this.config.endCallback;e&&"function"==typeof e&&e(this.config.id)}},{key:"_handleFormat",value:function(e,t,i,o){var n,s,r=this.config.format,a={"{d}":e,"{h+}":t,"{m+}":i,"{s+}":o};for(n in a)Object.hasOwnProperty.call(a,n)&&(s=a[n],new RegExp("("+n+")").test(r)&&(r=r.replace(RegExp.$1,3!==RegExp.$1.length&&s<10?"0".concat(s):s)));return r}},{key:"_handleSelector",value:function(){var e,t=this.config.selector;if(this.targetNodes={},!t)return this.hasNode=!1,void(this.targetNodes=null);if("string"==typeof t&&0===(this.targetNodes.value=document.querySelectorAll(t)).length&&(this.targetNodes=null,console.error("The node cannot be found: "+t)),"[object Object]"===Object.prototype.toString.call(t)){if(o(t))return this.hasNode=!1,void(this.targetNodes=null);for(var i in t)Object.hasOwnProperty.call(t,i)&&(e=t[i],0===(this.targetNodes[i]=document.querySelectorAll(e)).length&&(delete this.targetNodes[i],console.error("The node cannot be found: "+e)))}!this.targetNodes||o(this.targetNodes)?(this.hasNode=!1,this.targetNodes=null):this.hasNode=!0}}]),h}()}();